= –ü–∞—Ç—Ç–µ—Ä–Ω visitor
:icons: font

== –í–≤–µ–¥–µ–Ω–∏–µ

IMPORTANT: –í—Å—ë —á—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–æ –∑–¥–µ—Å—å -- –ø–æ–ø—ã—Ç–∫–∞ –æ–±—ä—è—Å–Ω–∏—Ç—å —à–∞–±–ª–æ–Ω –Ω–µ–º–Ω–æ–≥–æ —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∞ –∏–º–µ–Ω–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, –∫–æ–≥–¥–∞ –æ–Ω –Ω—É–∂–µ–Ω –≤ Java, –∏ –ø–æ—á–µ–º—É –≤ –Ω—ë–º –Ω–µ—Ç —Å–º—ã—Å–ª–∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —É –Ω–∞—Å –∏–º–µ—é—Ç—Å—è:

. –ò–µ—Ä–∞—Ä—Ö–∏—è —Ç–∏–ø–æ–≤
. –ö–ª–∞—Å—Å, —Å–ø–æ—Å–æ–±–Ω—ã–π –¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ —Å –∫–∞–∂–¥—ã–º –∏–∑ –∫–ª–∞—Å—Å–æ–≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏

[NOTE]
====
–í—Å–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ https://github.com/cac03/visitor-demo[`visitor-demo`]
====

=== –ò–µ—Ä–∞—Ä—Ö–∏—è —Ç–∏–ø–æ–≤

.https://github.com/cac03/visitor-demo/blob/main/src/main/java/com/caco3/visitor/java/unvisited/Any.java[`Any.java`]
[source,java]
----
public interface Any {
    class Ghost implements Any {
    }

    class Flower implements Any {
    }

    class Unicorn implements Any {
    }
}
----

3 –∫–ª–∞—Å—Å–∞: `Ghost`, `Flower`, `Unicorn`, –∫–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Any`.

=== –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å

–ó–∞–¥–∞—á–∞ _—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞_ -- —É–º–µ—Ç—å –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–∏–ø –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Any` –∏ Emoji, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –µ–º—É.

.https://github.com/cac03/visitor-demo/blob/main/src/main/java/com/caco3/visitor/java/unvisited/Printer.java[`Printer.java`]
[source,java]
----
public class Printer {
    public void print(Any any) {
        System.out.println("‚ùì - Any");
    }

    public void print(Ghost ghost) {
        System.out.println("üëª - Ghost");
    }

    public void print(Flower flower) {
        System.out.println("üå∫ - Flower");
    }

    public void print(Unicorn unicorn) {
        System.out.println("ü¶Ñ - Unicorn");
    }
}
----

–ö–ª–∞—Å—Å `Printer` –∏–º–µ–µ—Ç —á–µ—Ç—ã—Ä–µ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –º–µ—Ç–æ–¥–∞ `print`:

* –û–¥–Ω–∞ –∏–∑ –Ω–∏—Ö –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `Any` –∏ –≤—ã–≤–æ–¥–∏—Ç –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫
* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ç—Ä–∏ -- –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤, —Ä–µ–∞–ª–∏–∑—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

=== `main`

–î–æ–±–∞–≤–∏–º –º–µ—Ç–æ–¥ `main` –≤ —Ç–æ—Ç –∂–µ –∫–ª–∞—Å—Å:

.`Printer.java`
[source,java]
----
public class Printer {
    // ...

    public static void main(String[] args) {
        // <1>
        List<Any> list = List.of(
                new Ghost(),
                new Flower(),
                new Unicorn()
        );

        // <2>
        Printer printer = new Printer();

        for (Any any : list) {
            // <3>
            printer.print(any);
        }
    }
}
----
<1> —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ `Any`, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–≤–∏–¥–µ–Ω–∏–µ, —Ü–≤–µ—Ç–æ–∫ –∏ –µ–¥–∏–Ω–æ—Ä–æ–≥–∞
<2> —Å–æ–∑–¥–∞—ë—Ç—Å—è —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ `Printer`
<3> –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥ `print` –∫–ª–∞—Å—Å–∞ `Printer`

–¢—É—Ç –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≥–ª–∞–≤–Ω—ã–π –≤–æ–ø—Ä–æ—Å: _**–∞ —á—Ç–æ –≤—ã–≤–µ–¥–µ—Ç—Å—è, –µ—Å–ª–∏ —ç—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å?**_

–ê –≤—ã–≤–æ–¥ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º:

[source,text]
----
‚ùì - Any
‚ùì - Any
‚ùì - Any
----

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤—ã–≤–æ–¥—è—Ç—Å—è 3 –≤–æ–ø—Ä–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ Java –≤—ã–±–æ—Ä _–∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π_ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –º–µ—Ç–æ–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç *–Ω–∞ —ç—Ç–∞–ø–µ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏*.
–ê —Ç.–∫. —Ç–∏–ø –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `any` –≤ (3) -- `Any`, –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—ã–±–µ—Ä–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É –º–µ—Ç–æ–¥–∞, –ø—Ä–∏–Ω–∏–º–∞—é—â—É—é —Ç–∏–ø `Any`.

NOTE: –î–∞–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –∏–∑–≤–µ—Å—Ç–µ–Ω, –∫–∞–∫ https://en.wikipedia.org/wiki/Dynamic_dispatch#Single_and_multiple_dispatch[Single dynamic dispatch]: –≤—ã–±–æ—Ä –º–µ—Ç–æ–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç *–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏*, –Ω–æ –≤—ã–±–æ—Ä —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –æ–¥–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞: _–Ω–∞—Å—Ç–æ—è—â–µ–≥–æ —Ç–∏–ø–∞_, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è https://en.wikipedia.org/wiki/Virtual_function[–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã]

=== –í–æ–∑—å–º—ë–º Groovy

*Groovy* -- —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω—ã–π –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –Ω–∞ Java –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ.

–ï—Å–ª–∏ –º—ã –ø–æ–ø—Ä–æ–±—É–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ—Ç –∂–µ –ø—Ä–∏–º–µ—Ä –Ω–∞ –Ω—ë–º, —Ç–æ –≤—ã–≤–æ–¥ –±—É–¥–µ—Ç –¥—Ä—É–≥–∏–º:

[source,text]
----
üëª - Ghost
üå∫ - Flower
ü¶Ñ - Unicorn
----

_–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥: https://github.com/cac03/visitor-demo/blob/main/src/main/groovy/com/caco3/visitor/groovy/Any.groovy[`Any.groovy`]
–∏ https://github.com/cac03/visitor-demo/blob/main/src/main/groovy/com/caco3/visitor/groovy/Printer.groovy[`Printer.groovy`]_

–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç Java, Groovy -- **–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π**footnote:[–ï—Å–ª–∏ –Ω–µ –æ—Ç–∫–ª—é—á–∞—Ç—å –¥–∏–Ω–∞–º–∏–∑–º –≤ Groovy, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é https://docs.groovy-lang.org/latest/html/gapi/groovy/transform/CompileStatic.html[`@CompileStatic`]] —è–∑—ã–∫.
–í—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –∑–∞–≤–∏—Å–∏—Ç –≤ –Ω—ë–º _–Ω–µ —Ç–æ–ª—å–∫–æ_ –æ—Ç —Ç–∏–ø–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –Ω–æ –∏ –æ—Ç –¥—Ä—É–≥–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ -- —Ç–∏–ø–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

NOTE: –ü–æ-—É–º–Ω–æ–º—É —ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è https://en.wikipedia.org/wiki/Multiple_dispatch[Multiple dispatch]

–í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Groovy —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–æ –≤:

. –í —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å Java –≤ —Ä–∞–∑–¥–µ–ª–µ https://groovy-lang.org/differences.html#_multi_methods[Multi-methods]
. https://groovy-lang.org/objectorientation.html#_methods[–í —Ä–∞–∑–¥–µ–ª–µ, –ø–æ—Å–≤—è—â–µ–Ω–Ω–æ–º –º–µ—Ç–æ–¥–∞–º]

–ê —Å–∞–º –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã–±–æ—Ä–∞ –º–µ—Ç–æ–¥–∞ –¥–ª—è –≤—ã–∑–æ–≤–∞ –æ–ø–∏—Å–∞–Ω https://groovy-lang.org/objectorientation.html#_method_selection_algorithm[–∑–¥–µ—Å—å].

=== –ê –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è —Ç–∞–∫ –∂–µ –≤ Java?

–î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω visitor: –æ–Ω _–ø–æ–∑–≤–æ–ª—è–µ—Ç_ —ç–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏–∑–º —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞.

== –®–∞–±–ª–æ–Ω

–ß—Ç–æ–±—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–∏–º —à–∞–±–ª–æ–Ω–æ–º, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

. –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `+++*+++Visitor` –∏ –æ–±—ä—è–≤–∏—Ç—å –≤ –Ω—ë–º –º–µ—Ç–æ–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–¥—Ç–∏–ø–∞
. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `accept` –≤ –æ–±—â–∏–π –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏—Ö –Ω–∞—Å –ø–æ–¥—Ç–∏–ø–æ–≤ —Ç–∏–ø
. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `accept` —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –≤—ã–∑—ã–≤–∞–ª –Ω—É–∂–Ω—ã–π –º–µ—Ç–æ–¥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `+++*+++Visitor`, –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤ –Ω–µ–≥–æ `this`
. –í–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤—Å–µ–º –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–º —Ä–∞–Ω–µ–µ

WARNING: `+++*+++Visitor` -- –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Å–º—ã—Å–ª–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ `interface`, —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏ `class` / `abstract class`

_–ó–≤—É—á–∏—Ç —Å–ª–æ–∂–Ω–æ, –ª—É—á—à–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä._

=== –ü—Ä–∏–º–µ—Ä

==== –®–∞–≥ 1. –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `+++*+++Visitor`

–ò –æ–±—ä—è–≤–∏—Ç—å –≤ –Ω—ë–º –º–µ—Ç–æ–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–¥—Ç–∏–ø–∞:

.https://github.com/cac03/visitor-demo/blob/main/src/main/java/com/caco3/visitor/java/visitor/AnyVisitor.java[`AnyVisitor.java`]
[source,java]
----
public interface AnyVisitor {
    void visitGhost(Ghost ghost);

    void visitFlower(Flower flower);

    void visitUnicorn(Unicorn unicorn);
}
----

–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –æ–±—ä—è–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `visit`, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π –¥–∞–Ω–Ω—ã–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ–¥—Ç–∏–ø.

==== –®–∞–≥ 2. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `accept` –∫ –æ–±—â–µ–º—É —Ç–∏–ø—É

–¢—É—Ç –≤—Å—ë –ø—Ä–æ—Å—Ç–æ: –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±—ä—è–≤–∏—Ç—å –º–µ—Ç–æ–¥ `accept`, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ `AnyVisitor`:

.https://github.com/cac03/visitor-demo/blob/main/src/main/java/com/caco3/visitor/java/visitor/Any.java[`Any.java`]
[source,java]
----
public interface Any {
    void accept(AnyVisitor anyVisitor);
}
----

==== –®–∞–≥ 3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ `accept`

–¢—É—Ç —Ç–æ–∂–µ –≤—Å—ë –ø—Ä–æ—Å—Ç–æ: –≤ –∫–∞–∂–¥–æ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –ø–æ–¥—Ç–∏–ø–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥ `accept`, –≤—ã–∑–≤–∞–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `AnyVisitor`:

* –î–ª—è `Flower`:
+
[source,java]
----
class Flower implements Any {
    @Override
    public void accept(AnyVisitor anyVisitor) {
        anyVisitor.visitFlower(this);
    }
}
----
* –î–ª—è `Ghost`:
+
[source,java]
----
class Ghost implements Any {
    @Override
    public void accept(AnyVisitor anyVisitor) {
        anyVisitor.visitGhost(this);
    }
}
----
* –î–ª—è `Unicorn`:
+
[source,java]
----
class Unicorn implements Any {
    @Override
    public void accept(AnyVisitor anyVisitor) {
        anyVisitor.visitUnicorn(this);
    }
}
----

==== –®–∞–≥ 4. –°–≤—è–∑—ã–≤–∞–Ω–∏–µ –≤—Å–µ–≥–æ –≤–æ–µ–¥–∏–Ω–æ

–û—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤—Å–µ–º –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–º.

==== `Printer`

–°–ø–µ—Ä–≤–∞ –∏–∑–º–µ–Ω–∏–º –∫–ª–∞—Å—Å `Printer` —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞–ª –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `AnyVisitor`:

.https://github.com/cac03/visitor-demo/blob/main/src/main/java/com/caco3/visitor/java/visitor/Printer.java[`Printer.java`]
[source,java]
----
public class Printer implements AnyVisitor {
    @Override
    public void visitGhost(Ghost ghost) {
        System.out.println("üëª - Ghost");
    }

    @Override
    public void visitFlower(Flower flower) {
        System.out.println("üå∫ - Flower");
    }

    @Override
    public void visitUnicorn(Unicorn unicorn) {
        System.out.println("ü¶Ñ - Unicorn");
    }
}
----

–í –∫–∞–∂–¥–æ–º –∏–∑ –º–µ—Ç–æ–¥–æ–≤ `visit+++*+++` `Printer` –≤—ã–≤–æ–¥–∏—Ç Emoji –∏ –∏–º—è —Ç–∏–ø–∞.

==== `main`

–ê –≤ –º–µ—Ç–æ–¥–µ `main` —Ç–µ–ø–µ—Ä—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–∑—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥ `accept` –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Any`, –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤ –Ω–µ–≥–æ `Printer`:

[source,java]
----
public class Printer {
    public static void main(String[] args) {
        List<Any> list = List.of(
                new Ghost(),
                new Flower(),
                new Unicorn()
        );

        Printer printer = new Printer();

        for (Any any : list) {
            // –í–æ—Ç –∑–¥–µ—Å—å
            any.accept(printer);
        }
    }
}
----

–ò —Ç–æ–≥–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞, –Ω–∞–∫–æ–Ω–µ—Ü, –≤—ã–≤–µ–¥–µ—Ç:

[source,text]
----
üëª - Ghost
üå∫ - Flower
ü¶Ñ - Unicorn
----

== –ü–æ-–Ω–∞—É—á–Ω–æ–º—É

–®–∞–±–ª–æ–Ω visitor –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–¥–µ–ª–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –æ—Ç –∫–ª–∞—Å—Å–æ–≤, –Ω–∞–¥ –∫–æ—Ç–æ—Ä—ã–º–∏ –æ–Ω –æ–ø–µ—Ä–∏—Ä—É–µ—Ç.

_–í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã–≤–æ–¥–∏—Ç Emoji –∏ —Ç–∏–ø –≤ –∫–æ–Ω—Å–æ–ª—å._

–¢–∞–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ _–∞–ª–≥–æ—Ä–∏—Ç–º—ã_, –Ω–µ –∏–∑–º–µ–Ω—è—è —Å–∞–º–∏ –∫–ª–∞—Å—Å—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç–∞–µ—Ç.

[NOTE]
====
–í –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞ -- –º–µ—Ö–∞–Ω–∏–∑–º, –Ω–∞–∑—ã–≤–∞–µ–º—ã–π https://en.wikipedia.org/wiki/Double_dispatch[Double dispatch]: –≤—ã–±–æ—Ä –Ω—É–∂–Ω–æ–≥–æ _–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ_ –º–µ—Ç–æ–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–≤–∞–∂–¥—ã:

. –í `main`: `any.accept(visitor)`
. –í –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö `accept(AnyVisitor)` –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Any`
====

== –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

* https://asm.ow2.io/javadoc/org/objectweb/asm/ClassVisitor.html[`ClassVisitor`] –∏–∑ https://asm.ow2.io/[ASM] -- –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –±–∞–π—Ç-–∫–æ–¥–æ–º Java
* https://docs.oracle.com/javase/7/docs/jdk/api/javac/tree/com/sun/source/tree/TreeVisitor.html[`TreeVisitor`] –∏–∑ `javac` -- –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ Java

== –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

–¢–æ–≥–¥–∞, –∫–æ–≥–¥–∞:

* –ß–∏—Å–ª–æ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö _—Ä–µ–¥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è_ (–∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ)
* –ü–æ—Å—Ç–æ—è–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è *–Ω–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã* –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏

== –ò—Ç–æ–≥

* Visitor –æ—Ç–¥–µ–ª—è–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –æ—Ç –∫–ª–∞—Å—Å–æ–≤, –Ω–∞–¥ –∫–æ—Ç–æ—Ä—ã–º–∏ –æ–Ω –æ–ø–µ—Ä–∏—Ä—É–µ—Ç
* –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞, –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è —à–∞–±–ª–æ–Ω–æ–º, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –Ω–µ –≤–æ –≤—Å–µ—Ö —è–∑—ã–∫–∞—Ö: –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ "–∏–∑ –∫–æ—Ä–æ–±–∫–∏"
